# ==============================================================
# ðŸ“ˆ EvoluÃ§Ã£o dos Acessos MÃ³veis por Modalidade (2014â€“2024)
# GrÃ¡fico 03
# ==============================================================

import pandas as pd
import matplotlib.pyplot as plt

# -----------------------------
# 1) Carregar e preparar os dados
# -----------------------------
df = pd.read_excel("/content/8c4ccca6-fa7e-4840-b016-2047e0611982.xlsx")

# Extrair ano da coluna Data
df["Ano"] = pd.to_datetime(df["Data"]).dt.year

# Filtrar apenas anos de interesse
df_filtrado = df[df["Ano"].between(2014, 2024)]

# Agrupar por ano e modalidade
df_agrupado = (
    df_filtrado.groupby(["Ano", "Modalidade de CobranÃ§a"])["Acessos"]
    .sum()
    .reset_index()
)

# Separar sÃ©ries
anos = sorted(df_agrupado["Ano"].unique())
pos = df_agrupado[df_agrupado["Modalidade de CobranÃ§a"] == "PÃ³s-pago"]["Acessos"].values
pre = df_agrupado[df_agrupado["Modalidade de CobranÃ§a"] == "PrÃ©-pago"]["Acessos"].values

# -----------------------------
# 2) GrÃ¡fico de Linha
# -----------------------------
plt.style.use('seaborn-v0_8')  # estilo elegante

fig, ax = plt.subplots(figsize=(10, 5))

# SÃ©rie PÃ³s-pago
ax.plot(
    anos, pos,
    marker='o', markersize=7,
    label='ðŸ“ˆ PÃ³s-pago (crescimento)',
    color='royalblue', linewidth=2.5
)

# SÃ©rie PrÃ©-pago
ax.plot(
    anos, pre,
    marker='o', markersize=7,
    label='ðŸ“‰ PrÃ©-pago (queda)',
    color='indianred', linewidth=2
)

# ConfiguraÃ§Ãµes do grÃ¡fico
ax.set_title('ðŸ“Š EvoluÃ§Ã£o dos Acessos MÃ³veis por Modalidade (2014â€“2024)', 
             fontsize=14, weight='bold')
ax.set_xlabel('Ano')
ax.set_ylabel('Acessos Totais')

ax.grid(True, linestyle='--', alpha=0.6)
ax.legend(frameon=True, facecolor='white', edgecolor='gray')

plt.tight_layout()
plt.show()
